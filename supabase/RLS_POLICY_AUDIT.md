# Supabase RLS Policy Audit (as of 2025-06-28)

## RLS-Enabled Tables and Example Policies

### public.profiles

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Public profiles are viewable by everyone
  - Users can insert/update their own profile

### public.kyc_documents

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can view/insert/update their own KYC documents
  - Users can upload/view their own KYC documents (storage)
  - Admins can view all KYC documents

### public.positions

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can view/insert/update/delete their own positions

### public.orders

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can view/insert/update/delete their own orders

### public.position_updates

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can view/insert their own position updates

### public.asset_leverage_config

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Anyone can view leverage config

### public.margin_calculations

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can view/insert their own margin calculations

### public.account_metrics

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can insert/update/view their own metrics

### public.historical_market_data

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Allow public read access

### public.kyc_audit_log

- ENABLE ROW LEVEL SECURITY

### public.market_data

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Allow public read access
  - Only service role can modify

### public.order_history

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can insert/view their own history

### public.position_history

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can insert/view their own position history

### public.price_alerts

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can delete/insert/update/view their own price alerts

### public.risk_metrics

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can insert/update/view their own risk metrics

### public.trade_analytics

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can insert/update/view their own trade analytics

### public.trading_orders

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can create/update/view their own orders

### public.trading_positions

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can create/update/view their own positions

### public.user_account

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can update/view their own account

### public.user_portfolio

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can update/view their own portfolio

### public.user_trades

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can insert/update/view their own trades

### public.user_watchlist

- ENABLE ROW LEVEL SECURITY
- Policies:
  - Users can delete/insert/update/view their own watchlist

---

## Recommendations

- Review all policies above for least-privilege and business logic.
- Test with real users to ensure no over-permissive access.
- For any table not listed, check if RLS should be enabled.
- For public data, ensure only intended tables have public read access.

---

_Generated by GitHub Copilot on 2025-06-28._
